# MCP Chain CLI — Документация

## Общие принципы
- CLI — thin wrapper: только парсинг аргументов, вызов core-функций, вывод результата.
- Вся бизнес-логика, работа с файлами, сериализация, side-effect'ы (сохранение state, логирование) — только в core.
- Все данные (балансы, кошельки, блоки, валидаторы) берутся из state (data/state.json).

## Основные команды

### Кошельки
- Импорт кошелька:
  ```
  mcp wallet import "<seed-фраза>"
  ```
  При импорте начисляется 100 MCP (даже при повторном импорте).
- Список кошельков:
  ```
  mcp wallet list
  ```
  Выводит все адреса и балансы из state.
- Баланс кошелька:
  ```
  mcp wallet balance <address>
  ```

### Транзакции
- Отправить транзакцию:
  ```
  mcp send <from_seed> <to_address> <amount> [fee]
  ```
  Пример:
  ```
  mcp send "abandon abandon ... about" f0ca10c3... 10 0
  ```
  Баланс и nonce берутся из state. После отправки транзакция попадает в mempool, изменения в state — после включения в блок.

### Стейкинг
- Залочить стейк:
  ```
  mcp stake lock <address> <amount> <until>
  ```
- Информация о стейке:
  ```
  mcp stake info <address>
  ```

### Блокчейн
- Статус сети:
  ```
  mcp chain head
  ```
- Список блоков:
  ```
  mcp chain ls
  ```
- Проверка целостности:
  ```
  mcp chain verify
  ```
- Сводка по state:
  ```
  mcp chain state-summary
  ```

### Контракты
- Деплой контракта:
  ```
  mcp contract deploy <code> [args...]
  ```
- Вызов метода контракта:
  ```
  mcp contract call <address> <method> [args...]
  ```
- Вызов встроенного контракта:
  ```
  mcp contract proto-call <name> [key=value ...]
  ```

## Важно
- CLI не работает с wallets.json напрямую, только через state.
- Все изменения (балансы, стейки, блоки) отражаются в state и видны во всех CLI-командах.
- Для применения транзакций к state требуется работающий node (майнинг блока).

## Примеры
- Импортировать кошелёк и проверить баланс:
  ```
  mcp wallet import "legal winner thank year ... yellow"
  mcp wallet list
  mcp wallet balance <address>
  ```
- Отправить транзакцию:
  ```
  mcp send "<seed>" <to_address> 10 0
  ```
- Залочить стейк:
  ```
  mcp stake lock <address> 50 1000
  mcp stake info <address>
  ```
- Статус сети:
  ```
  mcp chain head
  mcp chain state-summary
  ```

## Архитектура CLI
- **CLI — только thin wrapper**: парсинг аргументов, вызов функций core, вывод результата.
- **Вся бизнес-логика** (транзакции, стейкинг, кошельки, контракты) реализована только в core-модулях.
- **После каждой операции, меняющей состояние** (транзакция, стейк, импорт кошелька, деплой контракта) — state автоматически сохраняется в файл (`data/state.json`).
- **CLI не работает с файлами напрямую** — только через core.

---

## Быстрый старт

1. **Сборка:**
   ```sh
   go build -o mcp ./cmd/mcp
   ```
2. **Запуск:**
   ```sh
   ./mcp <команда> [подкоманда] [аргументы]
   ```

---

## Примечания
- Все параметры сети и майнинга берутся из конфига (internal/config/network_config.go).
- Для работы с кошельками используется файл data/wallets.json.
- Для расширения CLI добавляйте новые команды в соответствующие файлы и регистрируйте их в RegisterCommands.
- **State автоматически сохраняется после каждой операции, меняющей состояние.** 